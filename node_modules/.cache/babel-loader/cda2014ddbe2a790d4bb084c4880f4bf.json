{"ast":null,"code":"var _jsxFileName = \"A:\\\\PORTF\\xD3LIO\\\\ProjetoNodeShopComRestAPI\\\\front-end-react\\\\src\\\\pages\\\\Checkout\\\\Checkout.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport CartItem from '../../components/Cart/CartItemList/CartItem/CartItem';\nimport CartItemList from '../../components/Cart/CartItemList/CartItemList';\nimport * as cartActionTypes from '../../store/actions/cart';\nimport Cart from '../../components/Cart/Cart';\nimport '../Cart/Cart.css';\nimport './Checkout.css';\nimport axiosOrder from '../../axios-orders';\nimport StripeCheckout from 'react-stripe-checkout';\nimport Spinner from '../../components/UI/Spinner/Spinner';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Checkout = props => {\n  _s();\n\n  const [currentUser, setCurrentUser] = useState();\n  const [toOrders, setToOrders] = useState(false);\n  useEffect(() => {\n    setCurrentUser(props.token);\n\n    if (currentUser) {\n      props.onFetchCart(props.token, props.userId);\n    }\n  }, [currentUser]);\n\n  let cart = /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 14\n  }, this);\n\n  const onToken = token => {\n    axiosOrder.post('/create-order', {\n      token: JSON.stringify(token)\n    }, {\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${props.token}`,\n        UserId: `${props.userId}`\n      }\n    }).then(res => {\n      setToOrders(true);\n    });\n  };\n\n  let redirectToOrders;\n\n  if (toOrders) {\n    redirectToOrders = /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/orders\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 24\n    }, this);\n  }\n\n  if (!props.loading && props.cart.products.length >= 1) {\n    cart = /*#__PURE__*/_jsxDEV(React.Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(CartItemList, {\n        children: props.cart.products.map(product => {\n          return /*#__PURE__*/_jsxDEV(CartItem, {\n            productId: product.productId,\n            quantity: product.quantity,\n            isCheckout: true\n          }, product.productId._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cart-results\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Total:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"US$ \", props.cart.totalPrice.toFixed(2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(StripeCheckout, {\n          token: onToken,\n          stripeKey: \"pk_test_51JzRu5CmbCw1fMfw67d3Wwex6B9QCbMHYAVNN8TS4mqwzz3jSg9kMa0QuejL7BXnb1MX09efAsMeNnCVF8KHL3WD0096Zc6CqK\",\n          name: \"Your Order\",\n          description: \"The items you ordered\",\n          amount: props.cart.totalPrice.toFixed(2) * 100,\n          image: \"https://stripe.com/img/documentation/checkout/marketplace.png\",\n          currency: \"BRL\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stripe-button-el\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Pay with Card\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 93,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), redirectToOrders]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Cart, {\n    children: cart\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 10\n  }, this);\n};\n\n_s(Checkout, \"ifjmJCrcA+Po6eyhibD9uiVsCH4=\");\n\n_c = Checkout;\n\nconst mapStateToProps = state => {\n  return {\n    cart: state.cart,\n    loading: state.cart.loading,\n    totalPrice: state.cart.totalPrice,\n    error: state.cart.error,\n    token: state.auth.token,\n    userId: state.auth.userId\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onFetchCart: (token, userId) => {\n      dispatch(cartActionTypes.asyncFetchCartStart(token, userId));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Checkout);\n\nvar _c;\n\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"names":["React","useEffect","useState","Navigate","connect","CartItem","CartItemList","cartActionTypes","Cart","axiosOrder","StripeCheckout","Spinner","Checkout","props","currentUser","setCurrentUser","toOrders","setToOrders","token","onFetchCart","userId","cart","onToken","post","JSON","stringify","headers","Authorization","UserId","then","res","redirectToOrders","loading","products","length","map","product","productId","quantity","_id","totalPrice","toFixed","mapStateToProps","state","error","auth","mapDispatchToProps","dispatch","asyncFetchCartStart"],"sources":["A:/PORTFÃ“LIO/ProjetoNodeShopComRestAPI/front-end-react/src/pages/Checkout/Checkout.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\n\r\nimport { connect } from 'react-redux';\r\n\r\nimport CartItem from '../../components/Cart/CartItemList/CartItem/CartItem';\r\nimport CartItemList from '../../components/Cart/CartItemList/CartItemList';\r\n\r\nimport * as cartActionTypes from '../../store/actions/cart';\r\n\r\nimport Cart from '../../components/Cart/Cart';\r\n\r\nimport '../Cart/Cart.css';\r\n\r\nimport './Checkout.css';\r\n\r\nimport axiosOrder from '../../axios-orders';\r\n\r\nimport StripeCheckout from 'react-stripe-checkout';\r\n\r\n\r\nimport Spinner from '../../components/UI/Spinner/Spinner';\r\n\r\nconst Checkout = (props) => {\r\n  const [currentUser, setCurrentUser] = useState();\r\n  const [toOrders, setToOrders] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setCurrentUser(props.token);\r\n    if (currentUser) {\r\n      props.onFetchCart(props.token, props.userId);\r\n    }\r\n  }, [currentUser]);\r\n\r\n  let cart = <Spinner></Spinner>;\r\n\r\n  const onToken = (token) => {\r\n    axiosOrder\r\n      .post(\r\n        '/create-order',\r\n        {\r\n          token: JSON.stringify(token),\r\n        },\r\n\r\n        {\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${props.token}`,\r\n            UserId: `${props.userId}`,\r\n          },\r\n        }\r\n      )\r\n      .then((res) => {\r\n        setToOrders(true);\r\n      });\r\n  };\r\n\r\n  let redirectToOrders;\r\n\r\n  if (toOrders) {\r\n    redirectToOrders = <Navigate to=\"/orders\"></Navigate>;\r\n  }\r\n\r\n  if (!props.loading && props.cart.products.length >= 1) {\r\n    cart = (\r\n      <React.Fragment>\r\n        <CartItemList>\r\n          {props.cart.products.map((product) => {\r\n            return (\r\n              <CartItem\r\n                key={product.productId._id}\r\n                productId={product.productId}\r\n                quantity={product.quantity}\r\n                isCheckout\r\n              ></CartItem>\r\n            );\r\n          })}\r\n        </CartItemList>\r\n        <div className=\"cart-results\">\r\n          <h2>Total:</h2>\r\n          <h2>US$ {props.cart.totalPrice.toFixed(2)}</h2>\r\n          <StripeCheckout\r\n            token={onToken}\r\n            stripeKey=\"pk_test_51JzRu5CmbCw1fMfw67d3Wwex6B9QCbMHYAVNN8TS4mqwzz3jSg9kMa0QuejL7BXnb1MX09efAsMeNnCVF8KHL3WD0096Zc6CqK\"\r\n            name=\"Your Order\"\r\n            description=\"The items you ordered\"\r\n            amount={props.cart.totalPrice.toFixed(2) * 100}\r\n            image=\"https://stripe.com/img/documentation/checkout/marketplace.png\"\r\n            currency=\"BRL\"\r\n          >\r\n            <div className=\"stripe-button-el\">\r\n              <button>\r\n                <span>Pay with Card</span>\r\n              </button>\r\n            </div>\r\n          </StripeCheckout>\r\n        </div>\r\n        {redirectToOrders}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  return <Cart>{cart}</Cart>;\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    cart: state.cart,\r\n    loading: state.cart.loading,\r\n    totalPrice: state.cart.totalPrice,\r\n    error: state.cart.error,\r\n    token: state.auth.token,\r\n    userId: state.auth.userId,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    onFetchCart: (token, userId) => {\r\n      dispatch(cartActionTypes.asyncFetchCartStart(token, userId));\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Checkout);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}